<!DOCTYPE html>
<html>
<head>
    <title>WebUSB LED Control</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding-top: 50px; }
        button { font-size: 20px; padding: 10px 20px; margin: 10px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>WebUSB LED Control ðŸ’¡</h1>
    <button id="connectButton">Connect to Device</button>
    <p>
        <button id="ledOnButton" disabled>Turn LED ON</button>
        <button id="ledOffButton" disabled>Turn LED OFF</button>
    </p>

    <script>
        const connectButton = document.getElementById('connectButton');
        const ledOnButton = document.getElementById('ledOnButton');
        const ledOffButton = document.getElementById('ledOffButton');

        let device;

        connectButton.addEventListener('click', async () => {
            try {
                // Request the device from the user.
                device = await navigator.usb.requestDevice({ filters: [{}] });
                await device.open();
                await device.selectConfiguration(1);
                // The interface number should match your device's configuration.
                // It's often 0 for the first vendor-specific interface.
                await device.claimInterface(0); 

                // Enable the control buttons after successful connection.
                connectButton.disabled = true;
                ledOnButton.disabled = false;
                ledOffButton.disabled = false;
                console.log("Device connected!");

            } catch (error) {
                console.error("There was an error connecting to the device:", error);
            }
        });

        async function sendData(data) {
            if (!device) {
                alert("Device not connected!");
                return;
            }
            try {
                // The endpoint number should match your device's configuration for OUT transfers.
                // It's often 1, 2, 3, etc. Check your device descriptors if needed.
                const endpointNumber = 1; 
                const dataToSend = new TextEncoder().encode(data);
                await device.transferOut(endpointNumber, dataToSend);
            } catch (error) {
                console.error("Error sending data:", error);
            }
        }

        ledOnButton.addEventListener('click', () => {
            sendData('1');
        });

        ledOffButton.addEventListener('click', () => {
            sendData('0');
        });
    </script>
</body>
</html>
